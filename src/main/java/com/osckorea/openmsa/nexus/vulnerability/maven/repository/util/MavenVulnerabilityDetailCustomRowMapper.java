package com.osckorea.openmsa.nexus.vulnerability.maven.repository.util;

import java.sql.ResultSet;
import java.sql.SQLException;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Component;
import com.osckorea.openmsa.nexus.vulnerability.maven.domain.MavenVulnerabilityDetail;
import com.osckorea.openmsa.nexus.vulnerability.maven.domain.MavenVulnerabilityDetailPrimaryKey;

@Component
public class MavenVulnerabilityDetailCustomRowMapper implements RowMapper<MavenVulnerabilityDetail>{
    @Override
    public MavenVulnerabilityDetail mapRow(ResultSet rs, int rowNum) throws SQLException {
        return MavenVulnerabilityDetail.builder()
                                    .primaryKey(MavenVulnerabilityDetailPrimaryKey.builder().componentPackageUrl(rs.getString("component_package_url")).id("id").build())
                                    .title(rs.getString("title"))
                                    .displayName(rs.getString("display_name"))
                                    .descripton(rs.getString("description"))
                                    .cvssScore(rs.getFloat("cvss_score"))
                                    .cvssVector(rs.getString("cvss_vector"))
                                    .cwe(rs.getString("cwe"))
                                    .cve(rs.getString("cve"))
                                    .referenceUrl(rs.getString("reference_url"))
                                    .externalReferenceUrl((String[]) rs.getArray("external_references_url").getArray())
                                    .build();
    }
    
}

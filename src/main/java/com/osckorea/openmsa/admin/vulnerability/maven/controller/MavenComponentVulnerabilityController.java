package com.osckorea.openmsa.admin.vulnerability.maven.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import com.osckorea.openmsa.admin.vulnerability.common.dto.ComponentVulnerabilityReportDto;
import com.osckorea.openmsa.admin.vulnerability.maven.service.MavenVulnerabilityOssIndexService;
import lombok.RequiredArgsConstructor;

@RestController
@RequestMapping("v1")
@RequiredArgsConstructor
public class MavenComponentVulnerabilityController {
    private final MavenVulnerabilityOssIndexService mavenVulnerabilityOssIndexService;

    @GetMapping("vulnerability/maven")
    public ComponentVulnerabilityReportDto.Response[] getOssIndexComponentVulnerabilityInfo(
        @RequestParam("group") String group,
        @RequestParam("name") String name,
        @RequestParam("version") String version) {
        return this.mavenVulnerabilityOssIndexService.getComponentVulnerability(group, name, version);
    }

    @GetMapping("vulnerability/components")
    public Object te(@RequestParam("repositoryName") String name) {
        return this.mavenVulnerabilityOssIndexService.test(name);
    }
}
